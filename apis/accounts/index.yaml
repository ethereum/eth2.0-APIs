get:
  tags:
    - Accounts
  operationId: "ListAccounts"
  summary: "List accounts."
  description: |
    List all accounts known to and decrypted to this validator client
  security:
    - cookieAuth: []
  parameters:
    - name: page_size
      in: query
      required: false
      description: "The maximum number of accounts to return in the response."
      schema:
        type: number
    - name: page_token
      in: query
      required: false
      description: "A pagination token returned from a previous call to `ListAccounts`. that indicates where this listing should continue from."
      schema:
        type: string
  responses:
    "200":
      description: Success response
      content:
        application/json:
          schema:
            title: ListAccountsResponse
            type: object
            properties:
              next_page_token:
                type: string
                description: "A pagination token returned from a previous call that indicates from where listing should continue."
                example: "150"
              total_size:
                type: number
                description: "Total count matching the request."
              accounts:
                type: array
                items:
                  type: object
                  properties:
                    validating_pubkey:
                      type: string
                      description: "The validating public key."
                    derivation_path:
                      type: string
                      description: "The derivation path (if present in the imported keystore)."
                    slashing_protection_last_entry:
                      type: string
                      description: |
                        Latest slashing protection DB data item associated with this pubkey.
                        Signal no slashing protection DB data with a value of TBD (0, null, "")

    "401":
      $ref: "../../validator-oapi.yaml#/components/responses/Unauthorized"
    "403":
      $ref: "../../validator-oapi.yaml#/components/responses/Forbidden"
    "500":
      $ref: "../../validator-oapi.yaml#/components/responses/InternalError"

post:
  tags:
    - Accounts
  operationId: "ImportAccounts"
  summary: "Import accounts."
  description: |
    Import keystores generated by the Eth2.0 deposit CLI tooling. All keystores MUST be encrypted with the same password.
  security:
    - cookieAuth: []
  requestBody:
    content:
      application/json:
        schema:
          type: object
          properties:
            keystores_imported:
              type: array
              description: "JSON-encoded keystore files to import during wallet creation."
              items:
                type: object
            keystores_password:
              description: "Password to unlock imported keystore files."
              type: string
  responses:
    "200":
      description: Success response
      content:
        application/json:
          schema:
            title: ImportAccountsResponse
            type: object
            properties:
              imported_pubkeys:
                type: array
                description: "List of successfully imported pubkeys."
                items:
                  type: string
    "401":
      $ref: "../../validator-oapi.yaml#/components/responses/Unauthorized"
    "403":
      $ref: "../../validator-oapi.yaml#/components/responses/Forbidden"
    "500":
      $ref: "../../validator-oapi.yaml#/components/responses/InternalError"

delete:
  tags:
    - Accounts
  operationId: "DeleteAccounts"
  summary: "Delete accounts."
  description: |
    Delete keystores for the pubkeys provided in the request. The validator client MUST stop validating
    with these keystores immediately and MUST return a 200 status only after confirming no more signatures
    can be created with those keys.
  security:
    - cookieAuth: []
  requestBody:
    content:
      application/json:
        schema:
          type: object
          properties:
            pubkeys:
              type: array
              description: "List of public keys to delete."
              items:
                type: string
  responses:
    "200":
      description: Success response
      content:
        application/json:
          schema:
            title: DeleteAccountsResponse
            type: object
            properties:
              deleted_pubkeys:
                type: array
                description: "List of public keys successfully deleted."
                items:
                  type: string
    "401":
      $ref: "../../validator-oapi.yaml#/components/responses/Unauthorized"
    "403":
      $ref: "../../validator-oapi.yaml#/components/responses/Forbidden"
    "500":
      $ref: "../../validator-oapi.yaml#/components/responses/InternalError"
